########################################################################
# This is the configuration file of GridPilot
#
# Sections:
#
# - GridPilot : contains general parameters
# - Databases : information about the database connection
# - - For each system defined in Databases, a section is required
# - Computing Systems : contains the list off every plug-ins (or computing systems)
# - - For each system defined in section Computing Systems, a section is required
#
# All tags are case insensitive, and a text after a # is a comment (but \# is allowed)
#
# In each plug-in section, two parameters are required :
# - ComputingSystem class : name of the class which implements the ComputingSystem interface
# - Database class : name of the class which implements the Database interface
# - working path : directory where scripts and ouptut are written
#
# Authors :
#
# - Vandy BERTEN (vandy.berten@cern.ch)
# - Luc GOOSSENS (luc.goossens@cern.ch)
# - Marco NIINIMAKI (marko.niinimaki@cern.ch)
# - Frederik ORELLANA (frederik.orellana@cern.ch)
#
########################################################################

[GridPilot]
user = firelord		# this name is only used for field in jobDefinition tables
resources = /resources/		# path of icons, help, ...
debug = 3			# debug level ; 0 : all debugs are disabled, 3 : maximum

# submission
maximum simultaneous submission = 1
time between submissions = 500 # in ms

# updates
maximum simultaneous checking = 4
time between checks = 500 # in ms

# validation
delay before validation = 100 # in ms
maximum simultaneous validating = 3

# timeouts : in seconds
default timeout = 60
submit timeout = 60
updateStatus timeout = 60
killJob timeout = 60
clearOutputMapping timeout = 60
exit timeout = 60
getFullStatus timeout = 60
getCurrentOutputs timeout =  60
db timeout = 60000

randomized submission = no

[Databases]
Systems = HSQLDB # MySQL@Geneva ProdDB@CERN # AMI@Grenoble
Show all transformations = true

[HSQLDB]
class = gridpilot.dbplugins.hsqldb.HSQLDBDatabase
driver = org.hsqldb.jdbcDriver
database = /tmp/AtlasDB
user = sa
password = ""

parameters = driver database user password

default dataset fields = name runNumber identifier
hidden dataset fields = projectName physicsWorkingGroup physicsShort detectorLayout status principalSite softwareRelease physicsPackage externalPackages outputFormat percentageValidatedFiles percentageFailedFiles totalFiles totalDataSize averageEventSize totalEvents averageCPUTime totalCPUTime requestedBy comment created lastModified transValues beam_energy mag_field beam_polarity beam_particle magneticField_Type ID_magneticField MBPL_magneticField MBPS_magneticField eta z theta Pix_StatusWord SCT_StatusWord TRT_StatusWord LAr_StatusWord Tile_StatusWord TileEB_StatusWord MDT_StatusWord TGC_StatusWord RPC_StatusWord CSC_StatusWord BEE_StatusWord Pix_xBeamPosition SCT_xBeamPosition TRT_xBeamPosition TRT_yBeamPosition TRT_zBeamPosition LArTile_xBeamPosition Muon_xBeamPosition MuonBee_xBeamPosition
default jobDefinition fields = name status

[MySQL@Geneva]
class = gridpilot.dbplugins.mysql.MySQLDatabase
driver = org.gjt.mm.mysql.Driver
database = jdbc:mysql://grid01.unige.ch:3306/AtlasDB
user = root
password = dummy

parameters = driver database user password

default dataset fields = name runNumber
hidden dataset fields = projectName physicsWorkingGroup physicsShort detectorLayout status principalSite softwareRelease physicsPackage externalPackages outputFormat percentageValidatedFiles percentageFailedFiles totalFiles totalDataSize averageEventSize totalEvents averageCPUTime totalCPUTime requestedBy comment created lastModified transValues beam_energy mag_field beam_polarity beam_particle magneticField_Type ID_magneticField MBPL_magneticField MBPS_magneticField eta z theta Pix_StatusWord SCT_StatusWord TRT_StatusWord LAr_StatusWord Tile_StatusWord TileEB_StatusWord MDT_StatusWord TGC_StatusWord RPC_StatusWord CSC_StatusWord BEE_StatusWord Pix_xBeamPosition SCT_xBeamPosition TRT_xBeamPosition TRT_yBeamPosition TRT_zBeamPosition LArTile_xBeamPosition Muon_xBeamPosition MuonBee_xBeamPosition
default jobDefinition fields = name status

[AMI@Grenoble]
class = net.hep.atlas.Database.Bookkeeping.GridPilot.dbplugins.ami.AMIDatabase
database = jdbc:mysql://atlasbkk1.in2p3.fr:3306/Atlas_Bookkeeping_01_00_00
#database = jdbc:mysql://pcitapi34.cern.ch:3306/Atlas_Bookkeeping_01_00_00
level = motherDatabase
site = CERN
project = dc1
step =  simulation
user = dc1
password = 

parameters = project level site  database step user password

transDB = Atlas_Recipes
default dataset fields = dataset.logicalDatasetName dataset.identifier
default jobDefinition fields = jobDefinition.LFN jobDefinition.jobDefinitionStatus

[ProdDB@CERN]
dbName = ProdDB@CERN
class = gridpilot.dbplugins.proddb.ProdDBDatabase
user = atlas_prodsys_dev # atlas_prodsys_dev atlas_prodsys
password = abrandnew_pw # prodsys
database = oradev.cern.ch:10521:D # oradev:10521:D pdbatlas:1521:atlassg
driver = oracle.jdbc.driver.OracleDriver
dbPrefix = # atlas_prodsys. # atlas_prodsys_dev atlas_prodsys

parameters = dbName driver database user password dbPrefix

dataset name = taskName
jobDefinition dataset FK = taskFK
jobDefinition name = jobName
dataset identifier = taskID
jobDefinition identifier = jobDefID
transformation identifier = jobTransID
default dataset fields = taskName status # * # 
hidden dataset fields = creationTime modificationTime actualPars taskTransFK
default jobDefinition fields = jobName controlState currentState inputHint maxAttempt priority events jobDefinitionID
hidden jobDefinition fields = maxAttempt controlState events jobDefinitionID

[Computing systems]
systems = # LSF@CERN

[LocalShellLinux]
## sub-Section for GridPilot
host = 
user =
password =
class = gridpilot.csplugins.localShell.LocalShellComputingSystem
home directory = ~/GridPilot
work path = gridJobs/
max jobs by update = 40

## sub-Section for this plug-in
shell = /bin/bash

[LocalShellLinux]
## sub-Section for GridPilot
host = lxplus.cern.ch
user =
password =
class = gridpilot.csplugins.localShell.LocalShellComputingSystem
home directory = /tmp
work path = gridJobs/
max jobs by update = 40

[LocalShellWindows]
## sub-Section for GridPilot
host = lxplus.cern.ch
user =
password =
class = gridpilot.csplugins.localShell.LocalShellComputingSystem
home directory = /tmp
work path = gridJobs/
max jobs by update = 40

[LSF@CERN]
## sub-Section for GridPilot
host = lxplus.cern.ch
user = fjob
password = 
class = gridpilot.csplugins.lsf.LSFComputingSystem
home directory = ~/GridPilot
working path = gridJobs/
max jobs by update = 40

## sub-Section for this plug-in
packageID = LSF@CERN
# TODO: drop all these
shell = /usr/bin/env zsh
submission command = bsub -q 1nh
#submission command = bsub  -R type==LINUX6 -q prod400 -R "cpuf>1.5&&maxmem>500"
check command = bjobs
copy command = rfcp
remove command = rfrm
mkdir command = rfmkdir
kill command = bkill

